Linley Henzell (linley.henzell@student.adelaide.edu.au)
12/09/99
* Fixed new berserk code to work with ctrl+direction attacks
* Now deletes savefiles after death (under DOS, at least)
* You no longer get xp for killing creatures which were created friendly
* A few low-level monsters added
* Initfile options:
   - Colour-code play-screen map, like the 'X' map
   - Remove monsters & clouds from map
* Horned characters can wear caps and hats
* Class named were put back into lower case, where appropriate
* You are now told when a monster's enchantments wear off (if in view)
* You get more information when you look at a monster
* Monsters no longer cast animate dead when there aren't any corpses in sight
* You can now use most abilities while hungry (not starving)
* Monster invisibility can now wear off (it couldn't before)
* Deflect and repel missiles enchantments now affect missile traps
* Dexterity affects your shield use
* Monster AI improvements:
   - Strong monsters no longer pick up missiles unless they're carrying some already
   - Some improvements made to monster path-finding
* USE_NEW_RANDOM rand() removed - the randart code relies on random()
* Ghosts now only do 2/3 as much damage; xp value reduced, too

Daniel Ligon (makmorn@qis.net)
11/18/99

* right justify prices in shops
* fixed the yellow Xom patch
* Xom sometimes answers prayers
* strengthen evasion
* enumerate the 'killed by' list, added "killed by an exploding spore".
* replaced many calls to "random() % x" to random2(x)
* eliminated calls to random3 and random4
* tone down Makhleb's minor destruction
* put amulets in the discovery listing
* fix beginning spells for kobold summoners
* invisible undead are now referred to as "it".
* permit Spriggan assassins.  The speed and low food requirements of a
  Spriggan are a great complement to the assassin's hand crossbow.

Brian Robinson (bcr19374@pegasus.cc.ucf.edu)
10/15/99

* you can now Acquire food.  It gives royal jellies to non
  ghouls, and royal jellies or chunks to ghouls.  I tried to
  get it to give you a variety of food, but it was a pain.
* added XOM_ACTS_YELLOW #define to AppHdr.h
* Added srand() to acr.cc so for the USE_NEW_RANDOM to work right.

Brian Robinson (bcr19374@pegasus.cc.ucf.edu)
10/14/99

* Fixed a problem where some super long strings in describe.cc got
  cut up, causing a compiler error.  (Please try to keep lines < 80
  characters whenever possible.)
* enummed describe_god() in describe.cc
* added makefile.sgi option to Makefile (although it doesn't work)
* Culled fixed bugs from Bugs.txt
* Added 'Easy Crawl' door opening.  Walking into a door now
  opens it.  Running into a door currently opens the door
  and stops.
* Added a GOD_NO_GOD case in describe_religion in describe.cc.
  It was a special case in acr.cc, but that's gone.
* added #include <stdio.h> to fight.cc and spells2.cc because
  they include sprintf().  Will compile and link properly
  without the include on Linux, but not in DOS.
* Tweaked makefiles .dos, .emx, and .sol

Brian Robinson (bcr19374@pegasus.cc.ucf.edu)
10/12/99

* Changed the version string to "3.40" and added a #define
  BUILD_DATE in version.h which is printed along with the
  version number.
* Added the USE_NEW_RANDOM #define to AppHdr.h
* Eliminated duplicate/done items from ToDo.txt.  Might have
  missed some of the done one's, though.  I only cut the one's
  that had done next to them.
* Changed inspect item command to 'v' in shops.
* moved the contents of oldmakefiles/ into a zip named oldmake.zip
* make distclean now deletes *.sav, *.lab, core, and *.0* in DOS
  and Linux.
* Some of the class names in newgame.cc were not capitalized. Fixed.
* Added a new random number generator.  Should be a little better
  than the old one, but it uses rand() rather than random() to
  get its number.  #define USE_NEW_RANDOM to use it.
* Noticed a bug in wizard mode where some creatures (necrophage)
  can reduce your max hp.  Normally this is okay because when you
  get down to zero, you die.  But in wizard mode, you end up getting
  negative max_hp, which results in the "you died, but its okay"
  message every turn.  I added you.max_hp = abs(you.max_hp) to the
  'h' wizard command, so you can get out of the negative max hps.
* Removed stethoscope from the 's' key in wizard mode.  Terribly
  annoying for me, since I can't rest with 5 in Linux.  You can
  get stethoscope by targetting or looking, so its no big deal.
* Scores now prints "Wiz" on any scores made from a WIZARD compiled
  program
* Added Daniel's patches:
  * XOM_ACTS_YELLOW is now a #define to make Xom messages be in yellow
  * Fixed the abyss crash bug
  * Added banish and Xom acts to the Wizard commands
* Swapped the v and V commands.  I think its more likely that someone
  would want to examine one of their items than check the version, so
  the examine command is lowercase.
* Added wizard help.  Can be accessed by hitting & then ?.  It simply
  lists the wizard commands like the normal help screen.
* Fixed a bug in Daniel's command code where you couldn't do the
  wizard command.
* Added wizard option to Makefile.  Same as debug but includes
  -DWIZARD
* Weapons of reaching used to attack one monster over another now
  have a chance to hit the monster inbetween.
* Giant races get a smaller penalty when using a large shield.
  Normal sized monsters may get a slightly larger penalty, but
  only by one or so.
* Added a function to debug.cc that just prints the

        "You have encountered a program bug.
         Please exit the level and save."

  message.  I replaced all occurances of these strings in the code
  with this function.
* Changed the haste and slow counters in acr.cc to take into account
  the amulet of resist slow.  Now haste subtract random2(2) each turn
  rather than one (which could lead to infinite haste but lets not
  worry about that), and the slow counter subtracts five instead of
  one each turn.

Brian Robinson (bcr19374@pegasus.cc.ucf.edu)
10/2/99

* Reformatted the help screen so that it is easier to see what you're
  looking for at a glance.  Also added a "more" capability so that
  if the command list goes over the screen size, you will get a more prompt
  and it will be displayed correctly.
* Changed the amulet of maintain speed to the amulet of resist slowness. The
  old description stated that it made you resist slow and made your speed
  better, but the code only made it so that you would resist slow.  So now
  if you have the amulet on, you get a +10 boost to any hasting, plus the
  maximum hasting you can have is bumped up 10.
* Changed some silly messages involving hasting and slowing.
* Tried to add some messages to the raise dead functions to indicate
  that you failed when you cast the spell, but I'm not sure they work.
  The code is very confusing.  They may only work some of the time.
* #ifdeffed LINUX the code in acr.cc from line 663 to line 676 which was
  using variables declared in another ifdef LINUX block.  This may have
  screwed something up because I'm not sure what's going on here.

Brian Robinson (bcr19374@pegasus.cc.ucf.edu)
9/29/99

* Fixed the highscore() function so that it doesn't take so long.
* Added some whitespace to the scores output so that it will look better.
* fixed a bug involving 'a' being in scores.  See Bugs.txt and ouch.cc
* added comments in enum.h showing where the unique monsters are
* Removed the first argument from draw_border in view.cc since it was
  always being passed the same value.
* Fixed a bug where the player's score was not always being saved.
* I noticed some problems with the new makefiles while compiling under
  DOS.  Any platform that has its own library (like liblinux) should be
  +='ed to OBJECTS in the system specific makefile.
* Added noopt (no optimization) to Makefile to allow me to compile under
  DOS with no headaches.

Daniel Ligon
28/09/99

-- renamed linuxlib to liblinux
-- turned on keypad for ncurses (linux port)
-- made kbhit() of liblinux.cc to always returned 0
-- made big lookup table in liblinux.cc to convert keypresses to
   commands
-- added enumerated commands to enum.h and to big switch in acr.cc
-- added Brian's makefiles

Brent Ross (bwross@csclub.uwaterloo.ca)
24/09/99

-- fixed evasion bug
-- reverted getch_mul function in macro.cc
-- red devils now have probablistic chance on trident/demon trident/no weapon
-- demon tridents are now correctly coloured
-- xp spending cap/MAX_SPENDING_LIMIT
-- made broad axe, spiked flail, great flail less common
-- reduced floating point operations in update_corpses()
-- all demonspawn scales/plates can be given at one or two levels
-- max max hit points are now displayed when the player's max is down
-- From Linley:
    -- fixed portal so that it doesn't go below level 27
    -- Fixed the checks for translocating in the abyss
    -- added fix for going to pandemonium or the abyss from hell
    -- added note about using + for targeting to various prompts
    -- ghosts now fade away only if they have less than half their hps

Linley Henzell (linley.henzell@student.adelaide.edu.au)
12/09/99
-- "Over-map" added
-- Messages can now be coloured. Just call set_colour before mpr.
-- Made wild magic effects do more harm, and increased likelihood of the
   higher levels of effect.
-- In the Abyss, blink may not work and teleport takes longer
-- Tweaked a few unrandarts
-- Rewrote part of the weapon generation function in dungeon.cc. Add a weapon
   rarity function.
-- Some monsters can now get a wider range of weapons.
-- Many high-powered demons increased in speed
-- Several changes to skills.cc. Now having many xp in the pool increases
   the cost of exercising.
-- Increased the threshold values for special "you hit" messages in fight.cc
   and patched some grammar.
-- Removed three 'silly' monsters (dorgi, Sword, Guardian robot)
-- Now, haste has a direct effect on time_taken, rather than being treated
   separately. See player_speed().
-- Boots of levitation now allow permanent hovering.
-- The random events in Hell are now much nastier
-- Clouds can now be overwritten by other clouds, sometimes (see place_cloud)
-- The monster mutation spell now affects monsters as polymorph
-- A new init-file variable (verbose) determines how much info about
   randarts and other magical items in the char dump.
- bugs fixed:
    -- monsters can now cast 'direct' spells (eg smiting) over other monsters
        if targetting the player.
    -- giants are now given the correct number of rocks.

Brent Ross (bwross@csclub.uwaterloo.ca)
09/09/99

-- lowered the damage of some of the new weapons, made tridents heavier.
-- added some changes to the newgame screens from Dustin Ragan

-- spellcasting reduced by weapon size (weight and/or speed)

- from Linley:
    -- made sure helmet/helm colour is initialised to LIGHTCYAN
    -- made it so that swapping item letters prints both affected items.
    -- fixed '=' --> '==' in randart.cc line 1515
    -- fixed more scrolling problem under DOS
    -- fixed problem with the ctrl-direction keys under DOS
    -- made subspecies selection a compile time option
    -- removed possibility of horns mutation for minotaurs

-- removed Great Swords skill
    -- great swords/triple swords are now long swords

-- changed Trolls + troll leather to have no effect
-- removed gdbm stuff -- makes things simpler, better security can wait
   until a new savefile system is done.

-- hand and a half weapons
    -- no bonus if weapon is cursed.
    -- 1-1/2 hand weapons don't get the speed bonus past 10
    -- 2 handed weapons can get as fast as speed 7 with skill
    -- +random2(3) to hit
    -- +random2(3) to dam (all two handed weapons) applied after skill
       multipliers (ie. with the dwarf and orc modifiers).

-- added code so that multiple shield blocks in a turn becomes increasingly
   difficult.

-- fighters now get dodging or armour based off of starting armour

-- shields and large shields now slow down attacks


Brent Ross (bwross@csclub.uwaterloo.ca)
08/27/99

-- added '*' for level 27 skills in character dump
-- removing the "skill_change /= 2" line from the spell skills was a bit
   hard on early spellcasters.  Since there's no reason for it in the
   mid-game, it seems logical to give it to low level characters and
   phase it out by the mid-game.

-- "Crush" was requiring conjurations (hold over from Throw Pebble)

-- bug fix: Having 1xp in the pool was allowing a lot of free practising.

-- upped penalty for heavy armour (to be more in line with the new penalty
   for shields).  Are these values high enough?

-- added Linley's suggested new weapons (Axe, Spiked Flail, Great mace,
    Great flail)

-- upped damage for some maces & flails (swords are quick and accurate,
   but maces and flails hit harder).

-- changed "Boots" to "Barding" in equipment list for centaurs and naga

-- made crystal plate mail somewhat resistant to corrosion.

-- added +/- markers to the Skills screen to help out people in monochrome.

-- bug fix: fixed labyrinth problems

-- bug fix: fix LOS corner problem

-- bug fix: can now make with -DWIZARD

-- removed spellcasting/invocation interference.

-- added broad axe (rare, 15, +3, 17), trident (9, -2, 16),
   and demon trident (evil -- wielded by red devils, 15, -2 16).

-- polearms/whips of reaching

-- gave gladiators the choice of using a trident to start.

-- removed USE_NEW_BERSERK define

-- fixed bug where the AC value of barding was incorrectly displayed.

-- quite a bit of cleanup (converting ints to enums in the old code)

-- cleaned up draconian AC gains... removed level four increase and gave
   them two AC to start.

-- added knife -- made guaranteed on the first three levels

-- fixed bug where memorizing spells was impossible on some terminals.


Brent Ross (bwross@csclub.uwaterloo.ca)
08/08/99

-- bug fix: Orange Brains could hang game (MS_SUMMON_LEVEL spell in abyss)

-- bug fix: monsters should no longer occur "under" the player

-- bug fix: portals weren't closed on the way out, but hell gates were removed
            ... now all are closed.

-- bug fix: cannot unlearn spells outside the array bounds.

-- bug fix: manuals should auto identify on the first read

-- bug fix: Healing book was available from acquirement/Sif Muna

-- fixed it so that missile launchers don't train/use the missile skill when
   used in melee (bows/xbows now train/use maces/flails, slings uses no skill)

-- bug fix: Zot traps should no longer give messages involving their effects
            on monsters, unless the monster is within line of sight.

-- bug fix: liquid flame could wrap around and last a long time

-- bug fix: that caused "program bugs" to occur in the abyss

-- bug fix: fixed number of cards in Decks of Power (it defaulted to zero
   and thus was giving 255 cards)

-- bug fix: fixed Nemelex to give cards instead of Bone Lanterns and
            Geryon Horns

-- bug fix: food not updating with cards

-- bug fix: quick blades were getting free actions

-- bug fix: spell points now update when you gain Invocations.

-- upped granularity of skill gain to reduce stage three
    -- upped number of learns from manuals to accomidate
    -- put reductions on XP values of monsters to try and reduce the
       "stage two" effect

-- downed the power of smiting again... it seems reasonable now.

-- teleport control restrictions (some areas don't allow controlled
   teleport now).

-- added stacking of runes

-- made invocations and spellcasting learning interfer like elemental magic

-- increased rate of skill cost per level

-- removed division by two for cost of spellcasting skills

-- upped the rarity of unique artefacts (all of these seem to come quickly
   into any game... except the Sword of Power, for which the 50% chance
   of not creating it probably kept it out of my last game for a while

-- evasion/shields are too good
    - raised shield blocking difficulty a bit (base 10 to 15)
    - made player's evasion rolled in the monster to hit check (so that
      a player with an EV of 30+ can still be hit)... added a 1/15
      chance of hitting regardless (players already got this advantage).

-- Moved the .h guards to after the headers (cosmetic)

Brent Ross (bwross@csclub.uwaterloo.ca)
07/30/99

-- fixed bug: visiting the abyss from the hall of blades results in the
   abyss being populated by blades

-- fixed problems with the highscore board running off the end of the line

-- resist electricity and resist poison are not absolute anymore, you
   now take 1/3 damage if you resist (you still don't get poisoned if you
   have poison resistance though)

-- fixed bug: storm dragon breath can now be resisted

-- draining drains available xp pool as well now

-- moved spell levels to a function to fix a bug where you could end up
   with a large number of negative spells (forgot spell that didn't
   exist).

-- made spellcasting more difficult to get

-- fixed plants stalking stairs

-- reverted dragon armours to original values... the resistances and benefits
   they give are good enough, its really the basic heavy armours that needed
   a bit of improvement.

-- fix for Distortion weapons (from Jesse).

-- deflect missiles status wasn't listed on '@'

-- slime pit runes are now only "possible" runes so you're unlikely to
   get four of them

-- added stats to "elf" dummy monster to allow elf zombies to live.

-- added redraw after projected noise

-- fixed bug where objects (runes, orb) were clobbered by items given to
   monsters.

-- fixed some monster descriptions that had huge gaps in them

-- bug fix: shapeshifters shouldn't polymorph into dancing blades (numbers
   for names)

-- acquirement is better for jewellery than before

-- fixed it so the skills screen can handle more than 26 skills.

-- levels of poison shown for '@'

-- traps get harder to disarm with dungeon level

-- traps can now go off when disarming

-- traps all handled by handle_traps now.

-- are the new traps too hard on monsters?
   -- probably yes, so they take the old damage for now.

-- made player_light_armour() which returns true if the player is in
   light or no armour.

-- fixed monsters interacting with traps bug... non-flying monsters were
   flying over them.

-- made polymorphed monsters not so much of an easy xp trick.

-- added monsters speed to the xp calculation

-- put cap on plant learning (no more than the first two levels of fighting
   skills)

-- added some support for destroying potions/food on ground from
   explosions... are only the correct things being destroyed? check
   bang.cc and destroy_item.

-- wearing heavy armour now gives a minium percentage of damage reduction.
    -- the percent is (skill + base AC of body armour)
    -- still needs to be applied to monsters, but monsters don't have
       a convienient way of knowing if they have hard armour (let alone
       an armour skill) so this can probably weight.

-- only heavy armour gives the extra protection from shrapnel attacks


Brent Ross (bwross@csclub.uwaterloo.ca)
07/13/99

-- blocked entrance to the labyrinth until its debugged

-- fixed the wizard code in acr.cc, changed some commands to easier
   to remember letters... added an identify.

-- fixed some cases where cursed jewellery plusses are assumed to
   be based off of 100, the creation code suggests that its 150 as
   does many other cases in the code.

-- random weapons, armour, and jewellery from acquirement() are now
   uncursed.

-- smoothed out the demonspawn horns so its possible to get twwo levels.

-- changed ranger to hunter

-- changed some gmon_use values (from Linley)

-- changed life protection descriptions

-- moved hunger_inc and ATTR_LIGHTNING_RESIST into functions in player(),
   the attribute is now replaced with ATTR_DIVINE_LIGHTNING_PROTECTION
   which is used to mark Makleb or Xom protecting the player from a
   lightning attack.

-- added checks for the curses keypad enums

-- lowered throwing weapon learning curve

-- lowered power of hand crossbows

-- lowered traps and doors learning curve

-- played with spellcasting staff identification

-- fix player ghosts
    -- monsters now regenerate hps while the player is off level
    -- ghosts regenerate and teleport away when the player leaves the level

-- changed assassins from ninja types to hand crossbow types... gave
   an enchanted dagger as well to help hand to hand.

-- added throwing exercise to darts, hand axes, daggers, and spears... and
   added throwing skill bonus for them as well (item_use.cc).

-- gave scythes, halberds, and glaives a chance at being weapons of speed.


Brent Ross (bwross@csclub.uwaterloo.ca)
07/07/99

-- fixed ice breathing dragon breath so it doesn't destroy walls

-- made life protection a level/3 chance

-- fixed the 120/150 hp ghost thing

-- anticheat code and security db for multiuser systems (requires gdbm)

-- made it so that only picking up items has delay with autopickup, walking
   over uninteresting stacks should cost no extra time now.

-- made berserk players fail the check_awaken test with monsters, and not
   spend experience on stealth.

-- added dexterity to stealth

-- gave ogre magi short swords instead of daggers.

-- toned down stabbing stun
-- toned down stabbing dex bonus - now limited by stabbing

-- assassins now start with a dagger, thieves start with short sword and dagger
-- reversed stats for thief and assassin, gave assassins unarmed combat

-- change wizards to be +7 int/+3 dex, thus making them smarter than
   the other spellcasters

-- draconian rangers no longer start with leather armour

-- toned down stealth a bit in player.cc:check_stealth(), and again

-- reduced to hit for throw fire/frost and sting (it_use2.cc:zappy())

-- fixed repel/deflect missiles problem -- changed bad REPEL reference in
   acr.cc

-- added message to unwielding vampiric weapons.

-- hacked up new keypad support for Unix

-- shots now are used up 1 in 3 times

-- added bonus to hit and dam for crossbows (item_use.cc)

-- added magic resistance for elves (player.cc)

-- upped autopickup delay to 3.  One and two seem to not be a delay at all.

-- opposing elemental staves now can be identified (items.cc, spell.cc)

-- added remove of zip file to ouch.cc to prevent cheating

-- STABBING check should be STEALTH in view.cc for the no yell check,
   lowered it to a straight percentage check

-- gave Dwarven/Orc rangers Dodging 1, because they were a bit short
   on skills

-- HOrs get orcish bolts (newgame.cc)
    - added MISSILES check in HILL_ORC check

-- Gladiator/Fighter changes (newgame.cc)
    - fighters are now: fighting 3, weapon 2, dodging/armour 2, shields 2,
                        stabbing/stealth 1, throwing 2, str + 7, dex + 3.
    - kobold/troll/ogre fighters are the same as before

    - gladiators are now: fighting 3, weapon 3, dodging/armour 2, shields 1,
                          unarmed combat 2, str + 6, dex + 4.

    - diffs:
        - fighters   - lost unarmed combat
                     - gained a level of shields, and a level of throwing

        - gladiators - lost 1 dodging/armour and 1 shield
                     - gained 2 unarmed combat

        - stat bonuses were swapped
        - switched gladiator and fighter armour


Brent Ross (bwross@csclub.uwaterloo.ca)
06/22/99

-- Ranger weapon variations (halfling slingers, dwarven crossbowers)

-- fix Rangers/Reavers problem.  Rangers are now "rangers" so there's
   no problem with two capital letter Rs.

-- stealth improvements
    -- monsters don't yell (2 * skill) % of the time (view.cc:monster_grid())

    -- Large races lose the stealth * 2, small races now get * 5/2
                                        (player.cc:check_stealth())
        -- Huge     x 1 : Troll, Ogre, Ogre Mage, Centaur
        -- Awkward  x3/2: Minotaur, Draconians
        -- Normal   x 2 : Everyone else
        -- Small    x5/2: Halfling, Gnome, Kobold, Spriggan, Naga
                            -- Naga's aren't small, but they're good

    -- stabbed sleeping monsters now get set the BEH_CHASING_I.

    -- can now have a (skill + dex) % chance of stabbing fleeing or confused
       monsters.  (fight.cc)

    -- backstab effectiveness depends on the monsters behaviour:
        - sleeping monsters are easy targets so lots of damage potential
        - fleeing and confused monsters so not as much damage potential
        - other cases have even less damage potential

    -- made backstabbing more effective for daggers
        - daggers add dex/3 damage before the multipliers (fight.cc)


-- modified fight.cc:monster_dies() so that *any* summoned creature
   killed by you or your pet won't call done_good.
        - Elivion/TSO/Zin have to be passed through, and aren't a
          problem because they can't abuse summoning anyways.
        - this could use a better fix (ie. keeping track of who summoned
          which monsters would help a lot)

-- fix monster polymorph to avoid NO_EXP monsters (Linley's suggestion)
    -- added mons_flag( targetc, M_NO_EXP_GAIN ) to do-while loop.

-- Remove teleport control + Blink spell combo (Jesse's suggestion)
    -- removed CONTROL_TELEPORT check from random_blink()

-- added racial bonus to worn armour in player_AC()

-- added food_change() and redraw to down_stairs to patch hunger status
   display bug


Brian Robinson (bcr19374@pegasus.cc.ucf.edu)
06/17/99

(Note: I've tried to annotate all my changes in the code  with my initials
       (BCR), so you can grep for them to find my changes.)

* did some small cleanup here and there

* wrote a new makefile for Linux.
  Made a number of changes to the make process which should save up some
  headaches in the future.  Now there is an OS_TYPE variable in the makefile
  that is automatically make into a #define in the make process, and that
  should make it easy to keep the makefiles straight on the OS.  Also moved
  the OBJECTS variable containing the list of the .o files to a file called
  make.obj which is included into the makefile.  This should save a little
  space and keep all the makefiles consistent on what objects they need.

* indented and added a header to defines.h

* fixed some oddness in newgame.cc.  Various system dependent name
  checks were all messed up in a bunch of nested #ifdef stuff.  Sorted it out.

* made the #define MACROS actually do something.  Now if you have it
  defined, the macros.h and macros.cc files will be used, otherwise they
  won't.  Right now, Crawl will not work correctly on Linux with MACROS on.
  See Bugs.txt for more details.

Brent Ross (bwross@csclub.uwaterloo.ca)
06/14/99

Some changes I added from Linley:
    * a fix for the geryon bug

    * message for berserkers chopping up corpses in rage.

    * changed some incorrect enums in it_use3.cc for Asmodeus's staff.

    * lowers XP penalty for demonspawn to 140%

    * fixed Elyvilon sacrifice code to limit abuse

    * renamed priest.cc, priest.h to abyss.

    * upped the spellcasting penalties for wearing shields to +5/+15/+30,
        from bucklers (+0), shield (+5), large shield (+15).

    * added random stat increase for Draconians


Brent Ross (bwross@csclub.uwaterloo.ca)
6/13/99

* fully separated Spriggans from the giant races, creating a separate block
  for tiny races in the armour wearing code.

* cursed rings identify themselves as sticky cursed when put on.

* updates weapon if you eat food that you're wielding

* black and grey scales were backwards in demonspawn (with regards to number
  of levels gained)

* in spells1.cc, blink() and random_blink()... removed the weapons
  check because the scan_randarts should be all that's required.

* fixed it so that teleport control works properly on blink (depended
  on order of includes and the compiler/system used).

* added #ifndef checking around all of the *.h files to try and avoid
  other problems like the above.

* added the full spell listing line to character dumps

* made creaky doors DEX + (Stealth + Traps) / 2 checks... added check on
  closing doors as well.

* upped the base values of heavy armour by 1 or 2 points.

* in spells3.cc, you_teleport().  Another case of only checking the
   weapon slot for a property.  Hopefully, I've changed all of these
   into scan_randarts.

* demonspawn() in mutation.cc had MUT_FAST twice, changed the second
  to MUT_SHOCK_RESISTANCE like the comment claimed.

* strength damage bonus had an ugly discreet nature to it, I multiplied
   the dammod values by 6 to get a smoother version of the same function.

* screen needed to be refreshed after spell slot changes.

* Implemented new equipment listing commands:
    -- )  lists current, swap a, swap b, and default 'f'ire weapons
    -- ]  lists worn armour
    -- "  lists worn jewelry (note: '=' is already used).

* shoot_skill = you.skills[SK_THROWING] in item_use.cc was wrong,
   it should clearly be CROSSBOWS when using a crossbow.

* handle traps in misc() used env.trap_known instead of trap_known
   (env.trap_known doesn't seem to be referenced anywhere else).

* Vehumet's gift was still not quite correct. -- fixed

* implemented magical Stave detection.  Staves may be detected over time,
  or whenever an appropriate magic is cast, depending on skill levels.

* Call Imp is too powerful for a level two spell, raised to level three

* added a little checking code in dungeon.cc for monster armour plusses

* more line was misplaced on the recognized item screen

* applied a mix of mine and DML's improvements for the temp file purging
  system.


David Loewenstern <loewenstern@home.com>
06/02/99
* added Makefile.dos
* updated define.h for compatibility with DJGPP
* cleaned up items.cc,monstuff.cc, mstuff2.cc,spells.cc,
  (mostly: corrected misassignments unsigned<->signed, unused vars, etc.)
* added enums: monstuff.cc, mstuff2.cc, beam.cc
* updated enum.h per above.
* added autopickup
* made '&' command only function in debug mode.
* remove_ring now uses inventory letter.
* more colorful "hits" in fight.cc (should be useful later to differentiate
  weapon types).
* fixed a bug in displaying the top scores when no score file had existed.


Jesse Jones (jesjones@halcyon.com)
05/30/99

* highscore() will print more scores on larger windows.
* wearing cloaks no longer prevents wearing or removing body armor
* armor can be dropped if it's worn and not cursed
* armor can be worn without removing the old armor
* Added missing ponderous armor message.
* Weapon line didn't always redraw when Blade Hands was cast (from Brent).
* detect_items uses '~' instead of '*' (from Brent).
* Changed wear_armour to allow Spriggan's to wear bucklers.
* Quit only pops up save changes dialog if game_has_started is true. (Mac)
* Replaced config.h with AppHdr.h
* All cc files include their header immediately after the AppHdr file.
* char_dump.cc dumps failure rates (from Brent).


Brent Ross (bwross@csclub.uwaterloo.ca)
5/?/99

* used GNU indent 1.91 (options -bad -bli0 -i4 -npcs -npsl), to hopefully
  get the intended BSD indentation style into the code.  Sorted some
  of the things indent won't help fix... more cleanup needs to be
  done here (notably with vertical whitespace and breaking up big lines),
  but it should at least be more readable now (no more column 0 code).
* various changes to make it work with NUMBER_OF_LINES instead of 25
* compile option to change default view to non-ibm graphics
* added ^R redraw screen command and added screen redraws to
  appropriate places
* added query to normal saves, ^X doesn't ask
* made ^Y work, and ^Z suspend for Unix systems
* added refresh call in beam.cc so beams are always visible
* added various things to deal with multiuser environment: compressing
  save files, handling permissions, global lib directory for game files,
  changes in name validation and file name structure (added uid).
* made the adjust item letter function swap items instead of fail
* made Selective Amnesia spell description less confusing
* made changes to make the targeting more intuitive for angband players
  (t and space accept targets), as well as behave better about canceling
  spells (added better abort)
* fixed unarmed combat so it takes the correct amount of time
* fixed a hunger/noisy wield bug where effects were not removed
* fixed a resist lightning bug where air staffs didn't grant it, yet
  took it away (ie. left the resist with a value of 255... quite good
  unless you put on something of resist lightning later).
* made rings/wands/scrolls and such print a message when they
  are identified by use
* fixed several cases where the wielded object was changed but the
  screen wasn't updated
* fixed bug where a triple level of a demonspawned mutation was never granted
* patched a bug where the inventory is full yet the count is
  wrong... this entire thing should be cleaned up
* fixed problem with curses attributes so that alternate character
  sets aren't used under Solaris (this is probably good for any
  Unix not on a IBM alternate character set box)
* fixed water and earth elementals for the same
* stone lined the finishing room so you can't dig through?
* removed some rather silly ways of clearing areas of the screen (under curses)
  and used the proper curses functions instead (much faster)
* fixed the bug where going up or down stairs would clear the food status
* fixed a few "typos" where the new enums were incorrectly substituted
  (ie. AC += SP_HIGH_ELF;      /* troll */ )
* fixed a few stat increases where the comment said "/* str or dex */", but
  was giving "str or int"
* increased Troll's food consumption to better balance the race.
* fixed Vehumet's gift giving code so it actually does what's intended
* added experience pool information to front page
* changed some of the duplicated titles (traps and doors)
* changed stairs out of sub-dungeons to be the '<' character, to reflect the
  key required
* made portals coloured on the level map... portals in pandemonium are
  intentionally all the same colour.
* added a stat increase for kobolds every 5 levels
* patched a bug that causes Demonspawn to sometimes not get their
  mutations.
* tried to make Armour skill a bit better -- get more in combat, a little
  more frequently otherwise.  Also, EV penalty is now recovered at skill/2.
* reduced the power of the Sword of Power (now +20 cap, HP/13 - 3)
* made creaking doors partially depend on skills (dex + traps + stealth,
  with a benifits of the last two dropping after a total of 10) instead of
  just luck... levitation isn't a sure way to avoid this now.
* made wield update after reading scroll of recharging
* extended the high score file to SCORE_FILE_ENTRIES items... currently only
  the first 15 are ever displayed by the program
* USE_NEW_BERSERK
    - makes berserk counter decrement faster when not attacking (currently
      using triagular progression)
    - butchery doesn't get penalized (in fact it resets the penalty
      counter), eating isn't either (but doesn't reset)
    - added exhausted counter to count berserk fatigue

    - hopefully this will eventually part of a new, better standard
      berserk.

* made skills fit onto screen by wrapping the first column if required.

* RAP_PREVENT_TELEPORT and the like didn't do anything because
   it doesn't use scan_randarts, but checks only the weapon... hopefully
   all the cases of this are fixed now.
* wield-amulet-that-you're-wearing bug fixed
* redraw for weapon when blade hands goes away

* #defines:
    - CRAWL_NAME and CRAWL_PIZZA, the first auto sets the players name,
      the second defines a string which describes the players choice of
      pizza, and has a greater chance than others of occuring.
    - handling the bstring.h/string include problem -- USE_BSTRING_H
    - added NUMBER_OF_RUNES_NEEDED and default set it to 3... this allows
      people to compile the game to require a certain number of runes to
      enter Zot's domain.
    - Added USE_CURSES define, for things specific to curses and not
      just PLAIN_TERM.
    - USE_TCHARS_IOCTL, USE_UNIX_SIGNALS, USE_SELECT_FOR_DELAY are there
      to solve various Unix variant problems should people need or want
      them.
    - USE_ASCII_CHARACTERS sets the default to the non-IBM character set.
    - SAVE_DIR_PATH is useful for setting a global lib directory for
      save files, bones files, and the score file.  SHARED_FILES_CHMOD_VAL
      is useful with this option on multi-user systems.
    - SAVE_PACKAGE_CMD, LOAD_UNPACKAGE_CMD, PACKAGE_SUFFIX are there for
      people who want to use a program to compress and bundle their
      save games when they're not playing.  Not pretty, but good enough
      until we come up with a better save file system.

* Added "(q to drink)" to fountain description when you step over one.
* Greater Healings bas has been upped to 50.
* Added Demonspawn transmuters.
* Spriggans and Halflings now use less food (-1).
* Wizard's hats and caps are now randomly coloured.
* Changed carrying capactiy to be less dependant on strength.  Pulled
  the carrying_capacity code into a function, as its called at various
  different places in the code.  Encumberance levels have been changes
  to represent a fraction of carrying capacity instead of constant
  values.
* Made named artefact weapons slightly rarer, Sword of Power now has
  1 in 2 check as well.

Jesse Jones (jesjones@halcyon.com)
5/?/99

* Fixed what appear to be three bugs involving extra semi-colons.
* File names can be longer than 6 characters and can include spaces.
* Added some debugging macros.
* dragon() wasn't handling fire drakes which meant the beam color was
uninitialized.
* getstr only adds printable characters to the buffer. (Mac)
* I've changed mons_spells() so that it returns a struct insted of using
an int
  array. (affects mstuff2.cc, mstuff.h and handle_wand).
* mons_near() now returns a bool. I've changed code like "mons_near(o) ==
1" and "mons_near(i) != 0" to "mons_near(o)" and "!mons_near(o)".
* print_description() no longer indexes past the end of the string.
* Made some minor changes to allow the code to be compiled with the
"require function protypes" warning.
* Added an UNUSED template function to config.h
* Rewrote describe.cc and describe.h
        - Reformatted
        - Uses string objects instead of hard-coded char arrays.
        - Split out 10 new functions from describe_item().
        - added get_item_description() and is_random_artifact()
* Rewrote chardump.cc
        - reformatted
        - uses string objects
        - split out 7 functions from dump_char
        - dumps artifact info.
* Reformatted viewwindow2(), added some ASSERTs, and split out
get_ibm_symbol().
* Reformatted monster() and split out 10(!) new functions.
* Reformatted mons_spells() and mons_cast(). mons_spells() case 49 uses
RED instead
  of (bogus) 20 for color.
* Added some ASSERTs to seekmonster().
* Renamed DEBUG WIZARD.
* Renamed DEBUG_BUILD DEBUG.
* Renamed manage_corpses() handle_time().
* Changed code to use new CORPSE_BODY and CORPSE_SKELETON enums.
* Deleted struct.h
* Added player::elapsed_time (holds the total amount of elapsed time in
the game).
* Tweaked level and game save routines to include a variable sized chunk
of extra data.
* Save level code saves a timestamp. Load level code uses timestamp to
update corpses
  and chunks.
* Renamed many of the player struct members.
* Renamed all of the monsters, item_struct, and ghost_struct members.
* Added comment blocks to the top of all files.
* Added TRACE debug function.
* you and env are no longer arrays.
* Fixed the bug in display_char_status that caused the wrong message to
be printed
  if the player had magic contamination.
* look_around() no longer prints a prompt (so things like blink and open
door no longer print "Press '?' for a monster description.").
* show_map accepts '\r' along with '.'.
* Cekugob no longer has fire and cold resistances.
* spellbook_contents prints unknown spells in light blue.
* show_map draws shops in yellow.
