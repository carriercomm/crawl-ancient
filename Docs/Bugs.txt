Bugs:

* DJGPP (dos compiler) may puke up a lung on some of the very long function if
  you try to compile in debug mode.

* values 250 - 310 should be reserved for Uniques in the monsters enum, but 260 - 280
  are occupied by other monsters.  Should move them if it won't mess anything else up.
  If they are moved, remember to alter the ouch.cc check to see if 'a' is put in front
  of the unique's name in the scores.

* Various odd effects when playing in term on Linux.  May be terminfo's fault.

*  "-5 stone" is heavily enchanted to do *more* damage and costs 100

*  "+6" was missile weapon generated in a jewellery shop

*  stop polearms of reaching from working over other monsters... might
   be a feature, though

*  backwards compatibility with save files is probably too far gone.

*  miscast effects are too weak?

*  targeting is off at times (possible rounding errors)

*  fired beams sometimes take the wrong route and can't hit targets in los

*  killed by program bug when killed by exploding spore

*  fix keypad... still broken

* cannot make the program with -DWIZARD (some files won't compile)
   -- fixed

* Skeletal Warrior cast a spell and seg faulted the game in the abyss.

* Makleb's Minor Destruction (first prompt '8' crashes game under DOS?)

* Macro code does not work properly in Linux.  When enabled, the user must hit
  two keys before any actions are executed, instead of having their actions
  executed immediately after each keystroke.  Quick fix is to disable macros
  from the Linux build, but eventually we want to get them working on Linux.
   -- fixed

* From the code it appears that dropping items takes zero time...

* Currently possible to gain 0hp when gaining a level... should
  be safeguards added to make sure this is at least never negative,
  if not guaranteeing 1hp / level.

* If you have teleport control you'll see a prompt that says, "You may
choose your destination (press '.' or delete to select)". I somehow got
into the habit of immediately blowing by this prompt without ever reading
it so I was always flailing around whenever I tried to teleport. I've
changed show_map() so that it accepts '\r' as well as '.' which should be
much more intuitive, but I don't see a check for the delete key in
show_map() so I think the prompt is wrong.

* Armour skill advances too slowly?
    >People here were never using heavy armour... banded, splint, scale, plate
    >are still completly ignored.  I did a few changes to make it more
    >on par with doging... ie I made it recover evasion every two instead of
    >every three levels, to help counter with the silly and hard to figure
    >out double penalty subtraction deal that destroys evasion when you
    >wear armour (add to that the penalty to hit, and the limited value of
    >armour points and its no wonder no one bothers).  Since its not as easy
    >to advance I gave it a slight nudge by increasing the exercise in combat
    >to 1 + random2(2).

        Maybe another solution would be to bump up the base AC values of
        each armour type. I only used the T$R standard values as a kind
        of default; I see no reason why plate mail should give 7 points
        instead of 12 or 15 (especially as the base AC of body armour
        is usually inconsequential compared to the protection offered
        by a set of magical gloves, boots, a cloak etc).

* Teleport control is really wacky. I'd expect to be able to use the
return key to select the square but it seems to key off one of the
keypad keys.

* Hunger status isn't redrawn when change level (definitely happens with
engorged and I think with full as well).
    -- should be fixed now (bwross)
    -- it's not fixed (JDJ)

* One cannot escape from the labyrinth.  He suggests looking at
the down_stair() and up_stair() functions, and disabling labyrinths
until this is fixed.

The problem seems to be that you arrive at a bad spot in the Labyrinth,
i.e., on the stairs "down" (and hence out).  These stairs are near the
center of the Labyrinth.  You *should* arrive at the stairs up, which
are on the periphery.  The stair you arrive on is destroyed, so as to
trap you in the Labyrinth.  Currently, the wrong stairs get destroyed,
and the stairs up don't go anywhere.

I think I've found the source of the problem.  Here is a partial diff
between the 3.20 and 3.30 versions of misc.cc:

< if (you[0].level_type == 1 || you[0].level_type == 2) stair_find = 81;
< if (you[0].level_type == 3) stair_find = 101;
---
> if (you[0].level_type == 1 || you[0].level_type == 2) stair_taken = 67; //81;
> if (you[0].level_type == 3) stair_taken = 101;

81 is the value for an entrance to the Labyrinth, and 67 is the value
for floor.  The actual stairwell gets converted to flooring earlier
in the code (or maybe that's the entrance to the Labyrinth that gets
converted).  But now the routine load() gets passed 67 rather than 81.
It's tough to follow from there, but load() tries to find a place to put
the player upon his arrival, and it works a lot harder when it gets 67.

I've changed the 67 back to 81 in my copy, and now I arrive somewhere
in the lower left hand corner of the Labyrinth.  In previous versions,
I arrived at the upper right corner, but I assume that this is OK.
Using the clockwise spiral technique, I was able to quickly maneuver
myself to the exit, kill the minotaur, and return to the dungeon.

The above code also effects the Abyss (level_type 2), which has a similar
"destroy this stairwell" feature.

* In 3.20, I had some problems in the Abyss.  I would step to
an open square, only to be told that hit/killed some monster
that wasn't there.  After killing several non-existent monsters,
I began killing "Program Bugs".
    -- fixed

* BTW you should not be reading the results of a monster stepping
in a Zot trap when it's out of sight... IIRC you got a message
saying "You hear a loud *Zot*!" or words to that effect.
    -- fixed

* I'm almost certain that monsters are triggering 'magic' traps
(ie teleport, amnesia, Zot), but not the 'missile' traps (ie darts
etc, including blade traps). There are two differences between these
traps in the code: flying/levitating monsters don't trigger missile
traps, and the two types are represented by different grid values.
Either all monsters are being interpreted as flying, or something is
preventing the game from calling some vital function when a missile
trap is triggered.

Here is code from mstuff2.cc:

    if (env[0].trap_type[tr] < TRAP_TELEPORT || env[0].trap_type[tr] ==
TRAP_BLADE || env[0].trap_type[tr] == TRAP_BOLT)
    {
        if (mons_flies (menv[i].m_class) == 0)
            return;             /* Flying monsters can avoid mechanical
                                 * traps, but not magical ones */
    }

It looks to me like non-flying monsters avoid mechanical traps.  In
my copy I have changed this to:

    // Flying monsters can avoid mechanical traps, but not magical ones
    if (      mons_flies (menv[i].m_class)
         && ! is_magical_trap( env[0].trap_type[tr] )
       )
    {
        return;
    }

where I define the subroutine is_magical_trap() further up in the
code.  I'll let you know if I see any differences in monster/trap
interactions.

* In decks.cc, we see:

        case 3:
        mpr("You have drawn Experience.");
        if (you[0].xp < 27)
         you[0].xp = exp_needed(you[0].xl + 2, you[0].species) + 1;
        level_change();
        break;

We should use you[0].xl, not you[0].xp.

* "Blade hands" is displayed as your weapon after your hands have
returned to normal.

I've fixed this (I think) in my copy.

    -- fixed in dev copy now (bwross)

* An item is cursed if its "iplus" value is "big enough".  However, "big
enough" is >80 in some places, >130 in others, and perhaps >120 in others.
I'm not sure about the 120 -- I recall seeing it but can't find it now.

Right now a have an artifact ring that I can't uncurse since the value
used is when uncursing is 130, and the value used when sticking is 80.
The uncursing code checks against 80 for one hand, and against 130 for
the other.

* Artifact weapons of Holy Wrath can be wielded by undead.

* Selective Amnesia spell description is confusing?
    -- removed the last phrase which said you could learn
       it with a shortage of "spell levels", it meant spell slots...
       it was overly redundand anyways (bwross)

* Line of sight code seems flaky: fairly often bits of the dungeon
become visible even though they're in an unconnected part of the map.

* Cloaks of poison resistance don't work. It looks like I added
this new type of cloak without also adding a check in the
player_res_poison function in player.cc. This should be easy to
fix.

* I found "an amulet of Cekugob". This is an "unrandart" and
should be identified as "the amulet of Cekugob". Also, a 'V'
check indicated none of its powers, but at least some of them
were being applied to my char. I don't know exactly what's
going on here, but I'll check the next time I'm at my
parents' house.

* The game tells if a monster is a shapeshifter by looking at its
mench values (ie the 3-element enchantment array). If enchantment
1 indicates that it's a shapeshifter (I forget the value; it's
thirty-something IIRC) it has a chance of polymorphing randomly
every move it makes ("glowing shapeshifters" are similar; they
just polymorph more often). The bug occurs when the shifter turns
into a plant or a fungus; these monsters aren't checked for
enchantments, so the shifter is trapped in a vegetable or fungus
form forever.

This should probably be fixed in monster_polymorph. I suggest
that monster types with the NO_EXP flag (currently only the plant
and fungus monsters) be made invalid target types for polymorph.
Possibly this should only apply to shapeshifters, as it's kind of
fun to zap something with a wand of polymorph and have it turn
into a plant...

* I've discovered another bug... It seems that some of the
functions which should be checking all of the player's wielded
or worn randarts for certain properties are still only checking
weapons. In particular I notice that the "it prevents
spellcasting" 'power' isn't being checked properly for armour
at least... Could someone have a look at the code involved
(it's either in the main input function or in the spellcasting
function called from there) and change what I suspect is a simple
call to randart_wpn_properties to a call to scan_randarts, which
is what should be there?

Could someone also check the teleport functions for the same
problem? I think the "it prevents some forms of teleportation"
power is working as advertised, but without access to the code
or a debugging version I can't be entirely sure.

* Sometimes when I target a spell like fireball, I can target a
square that I can't see, and other times I can't.

* I have had monsters shout upon seeing me, when I couldn't see them.

* When ascending stairs, there are three unlit squares in each quadrant
that will light after waiting a turn.

* beams aren't always visible
    -- should be fixed (at least for curses) (bwross)

* Unarmed combat doesn't take the right amount of time?
    -- fixed (bwross)

* Noisy wield bug?
    -- fixed (bwross)

* Resist lightning air staff bug?
    -- fixed (bwross)

* Screen isn't always updated when wielded object changes?
    -- hopefully fixed most of these (bwross)

* Triple level of a mutation is never granted?
    -- from perma_mutation, a la demonspawn... fixed (bwross)

* Going up or down stairs can clear the food status?
    -- fixed (bwross)

* Stat increases message is printing wrong stat?
        What I found
        was that the stats in the program are numbered like they are in the
        character dump (str, dex, int), not like they are on the screen
        (str, int, dex).  On random stat increases, some races (minotaur
        is one) have a comment which says /* str or dex */, but what
        it gives is str or int (obviously a confusion between the two
        orderings).
    -- actually the stats that were given didn't match the comments,
       fixed (bwross)

* Vehumet gift giving code is bogus?
    -- fixed (bwross)

* Demonspawn don't always get their mutations?
    -- patched, demonspawn should always get something when demonspawn()
       is called now (bwross)

* Sword of Power is too buff?
    -- somewhat less powerful now [max +20, div 13] (bwross)

* Keypad handling is weak?

* Fix the inventory count bug.  The inventory counter occasionally
  gets out of sync, it should either be moved or fixed.

* Check things for screen length problems, and fix them... ie. map centering
  is still off base line 12, should this be shifted for longer windows?

* Is food caching fix correct... food seems to disappear quickly, rather
   than rot away
    -- it doesn't seem quite right: food will sometimes rot, but more often
    it seems to disappear too quickly (JDJ)

* Animate skeleton doesn't work on some skeletons?

* Entering Ecumenical Temple may cause game to crash?

* Missing space when printing gold amounts?

* Full inventory doesn't account for the possibility of items stacking or
  for picking up gold.

* Conjure flame should do damage at a constant rate, not when creatures
  in it move.

* "You are You escaped."  line in character dumps.
    -- fixed (bwross)

* Geryon should only appear once

* Sometimes fixed Runes aren't created (are destroyed?)

* Multiple Orbs of Zot sometimes occur on the bottom level.

* Friendly creatures become hostile... may occur when player loses
  invisibility while the creature is in view.

* Teleport/Blink + Control is too powerful -- especially for vaults

* EV seems to get screwed up after transforms, it seems to get
   at the transform value when the player has no armour (calculated
   correctly once armour is on).

* Using stairs/portals sometimes misplaces the player (either into
  solid rock, or onto bogus levels (level 28 of the dungeon, level
  -1 of a sub-dungeon).

* The fact that ghost can't follow the player up stairs is a problem.
  Suggested solution is to teleport the ghost away and heal it.

* Giant spores should affect food on ground as well as in inventory
